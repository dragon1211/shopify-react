<!-- Mikawaya 商品ページウィジェット ver:5 -->
{% if product.selling_plan_groups.size > 0 %}
{{ 'mikawaya-product-page-widget-v5.css' | asset_url | stylesheet_tag }}

<div id="mikawaya-product-page-widget-container" class="mikawaya-hidden mikawaya-product-page-widget-container">
    {% unless product.requires_selling_plan == true %}
    <div class="mikawaya-one-time-or-subscription-selection-container">
      <div class="mikawaya-one-time-or-subscription-selection-box">
        <input hidden type="radio" name="purchase_option" checked value="one-time" onchange="window.MIKAWAYA.handleSellingPlanGroupChange(event)" class="mikawaya-radio-button"
          id="one-time-purchase-option">
        <label for="one-time-purchase-option" class="mikawaya-purchase-option-label__selected" id="one-time-purchase-option-label">
          <div>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50" class="mikawaya-selected-purchase-option-svg" id="mikawaya-one-time-selected-svg">
              <path class="input-label__selected" d="M30,0A25,25,0,1,0,55,25,25,25,0,0,0,30,0ZM41.31,20.89,25.44,35.06a2.45,2.45,0,0,1-1.63.62l-.28,0a2.43,2.43,0,0,1-1.71-1l-5.15-7.29a2.45,2.45,0,0,1,4-2.83l3.57,5.06L38.06,17.24a2.44,2.44,0,0,1,3.25,3.65Z"/>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50" class="mikawaya-one-time-purchase-option-svg">
              <g id="one-time-svg">
                <path class="input-label__selected" d="M11.67,3.33H5A1.67,1.67,0,1,1,5,0h6.67a1.67,1.67,0,0,1,0,3.33Z" />
                <path class="input-label__selected" d="M20,41.67a1.67,1.67,0,0,1-1.63-1.32L10,2a1.67,1.67,0,0,1,3.26-.71l8.33,38.34a1.67,1.67,0,0,1-1.28,2A2.09,2.09,0,0,1,20,41.67Z" />
                <path class="input-label__selected" d="M50,35H25a1.67,1.67,0,1,1,0-3.33H48.65l4.29-20H15a1.67,1.67,0,0,1,0-3.34H55a1.66,1.66,0,0,1,1.63,2l-5,23.33A1.67,1.67,0,0,1,50,35Z" />
                <path class="input-label__selected" d="M44.17,50A5.84,5.84,0,1,1,50,44.17,5.84,5.84,0,0,1,44.17,50Zm0-8.33a2.5,2.5,0,1,0,2.5,2.5A2.5,2.5,0,0,0,44.17,41.67Z" />
                <path class="input-label__selected" d="M22.5,50a5.84,5.84,0,1,1,5.83-5.83A5.84,5.84,0,0,1,22.5,50Zm0-8.33a2.5,2.5,0,1,0,2.5,2.5A2.5,2.5,0,0,0,22.5,41.67Z" />
                <path class="input-label__selected" d="M53.33,41.67H20a1.67,1.67,0,0,1,0-3.34H53.33a1.67,1.67,0,0,1,0,3.34Z" />
              </g>
            </svg>
          </div>
          <p id="one-time-purchase-text">
            <b>
            通常の購入
            </b>
          </p>
        </label>
      </div>
      <div class="mikawaya-one-time-or-subscription-selection-box">
      <label class="mikawaya-purchase-option-label" id="subscription-purchase-option-label">
        <input hidden type="radio" value="subscription" name="purchase_option" onchange="window.MIKAWAYA.handleSellingPlanGroupChange(event)" class="mikawaya-radio-button">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50" class="mikawaya-selected-purchase-option-svg" id="mikawaya-subscription-selected-svg">
            <path class="input-label__selected" d="M30,0A25,25,0,1,0,55,25,25,25,0,0,0,30,0ZM41.31,20.89,25.44,35.06a2.45,2.45,0,0,1-1.63.62l-.28,0a2.43,2.43,0,0,1-1.71-1l-5.15-7.29a2.45,2.45,0,0,1,4-2.83l3.57,5.06L38.06,17.24a2.44,2.44,0,0,1,3.25,3.65Z"/>
          </svg>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50" class="mikawaya-one-time-purchase-option-svg">
            <g id="subscription-svg">
              <path class="input-label" d="M16.72,12.55A18,18,0,0,1,29.6,7.22l-.09,4.38,7.74-5.31L29.73.49l-.08,4.14A20.76,20.76,0,0,0,14.89,40.07a20.64,20.64,0,0,0,5.18,3.78l1.19-2.3a18.18,18.18,0,0,1-4.54-29Z"/>
              <path class="input-label" d="M20.18,44.18,20,44.07A21,21,0,0,1,8.57,25.39a21,21,0,0,1,20.84-21L29.5,0l8.16,6.31-8.41,5.76.1-4.6A17.71,17.71,0,0,0,16.9,12.72h0a17.94,17.94,0,0,0,4.47,28.61l.22.11ZM29.5,4.87A20.52,20.52,0,0,0,9.06,25.39a20.35,20.35,0,0,0,6,14.5A20,20,0,0,0,20,43.52l1-1.87a18.43,18.43,0,0,1-4.38-29.27h0a18.18,18.18,0,0,1,13-5.4h.34l-.09,4.15,7.07-4.85L30,1l-.08,3.89H29.5Z"/>
              <path class="input-label" d="M45.11,9.93a20.64,20.64,0,0,0-5.18-3.78l-1.19,2.3a18.18,18.18,0,0,1,4.54,29A18,18,0,0,1,30.4,42.78l.09-4.38-7.74,5.31,7.52,5.8.08-4.14h.15A20.77,20.77,0,0,0,45.11,9.93Z"/>
              <path class="input-label" d="M30.5,50l-8.16-6.31,8.41-5.76-.09,4.6A17.91,17.91,0,0,0,48.34,24.61,17.94,17.94,0,0,0,38.63,8.67l-.22-.11,1.41-2.74.22.11a20.94,20.94,0,0,1,5.25,3.83h0a21,21,0,0,1,0,29.7,20.79,20.79,0,0,1-14.7,6.16Zm-7.33-6.28L30,49l.08-3.9h.39a20.31,20.31,0,0,0,14.44-6,20.52,20.52,0,0,0,0-29h0A20.36,20.36,0,0,0,40,6.48l-1,1.87a18.42,18.42,0,0,1,4.38,29.27,18.18,18.18,0,0,1-13,5.4h-.33l.08-4.15Z"/>
            </g>
          </svg>
        </div>
        <p id="subscription-purchase-text">
          <b>
          定期購入
        </b>
        </p>
      </label>
    </div>
      
    </div>
    {% endunless %}

    <p id="mikawaya-product-page-widget-container-v5-price" class="mikawaya-price"></p>
    <p id="mikawaya-product-page-widget-container-v5-description"></p>

    {% for variant in product.variants %}
    <span name="one-time-variant-price" data-variant-id="{{ variant.id }}" class="mikawaya-hidden">{{ variant.price | money }}</span>
    {% endfor %}

    {% for variant in product.variants %}
    {% for selling_plan_allocation in variant.selling_plan_allocations %}
    <div name="variant-group-allocation" data-variant-id="{{ variant.id }}" data-group-id="{{ selling_plan_allocation.selling_plan_group_id }}" data-selling-plan-id="{{ selling_plan_allocation.selling_plan.id }}"
      data-selling-plan-allocation-price="{{ selling_plan_allocation.price | money }}" style="display:hidden"></div>
    {% endfor %}
    {% endfor %}

    <div id="mikawaya-selling-plan-groups-container-v5" class="mikawaya-hidden">
    <!-- Selling plan groups -->
    {% for group in product.selling_plan_groups %}
    <div name="selling-plan-group-container" data-group-id="{{ group.id }}" class="mikawaya-selling-plan-group-container mikawaya-hidden" data-group-index="{{ forloop.index0 }}">
      <div>
        <input hidden type="radio" value="{{ group.id }}" name="purchase_option" onchange="window.MIKAWAYA.handleSellingPlanGroupChange(event)" class="mikawaya-radio-button">
        <span>お届けサイクル&nbsp;&nbsp;&nbsp;<span name="group-inline-price" data-group-id="{{ group.id }}" style="display:none"></span></span>
      </div>
      <select name="select-selling-plan" data-group-id="{{ group.id }}" onchange="window.MIKAWAYA.handleSellingPlanChange(event)">
        <!-- Individual selling plans -->
        {% for selling_plan in group.selling_plans %}
        <option value="{{ selling_plan.id }}">{{ selling_plan.name }}</option>
        {% endfor %}
      </select>
      {% for selling_plan in group.selling_plans %}
      <p style="display:none" name="selling-plan-description" data-group-id="{{ group.id }}" data-selling-plan-id="{{ selling_plan.id }}" {% if forloop.first %} class="mikawaya-selling-plan-description" {% else %}
        class="mikawaya-selling-plan-description mikawaya-hidden" {% endif %}>{{ selling_plan.description }}</p>
      {% endfor %}
    </div>
    {% endfor %}
  <input type="hidden" name="selling_plan" value="" id="mikawaya-hidden-selling-plan-id">
  <div type="hidden" id="current-variant-id" data-variant-id="{{ product.selected_or_first_available_variant.id }}" class="mikawaya-hidden">
  <div id="mikawaya-first-or-selected-gropu-id" data-first-group-id="{{ product.selected_or_first_available_selling_plan_allocation.selling_plan_group_id }}"></div>
  </div>
</div>
  
</div>
{{ 'mikawaya-product-page-widget-v5.js'  | asset_url | script_tag     }}
{% endif %}
